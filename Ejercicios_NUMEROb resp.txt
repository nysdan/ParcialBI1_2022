# Parcial Bioinformática 1 2022


1. Dados los archivos adjuntos Org1.pep y Org2.pep, ejecuta el BLAST apropiado de Org1 contra Org2, agregando los argumentos necesarios para que:

- El archivo de salida se llame tablast_12
- tablast_12 sea una tabla que contenga las siguientes columnas:
	1. qseqid
	2. sseqid
	3. pident
	4. sstart
	5. send
	6. slen
	7. evalue
	8. bitscore
- Todos los hits reportados en la tabla deben tener un evalue menor a 1E-15


### Respuesta (1)

makeblastdb -in Org2.pep -dbtype prot -out Org2base
blastp -query Org1.pep -db Org2base -out tablast_12 -outfmt '6 qseqid sseqid pident sstart send slen evalue bitscore' -evalue 1e-15 -num_threads 2

2. Determinar, utilizando una terminal de Linux 
   
	2.a. ¿Cuántas secuencias query diferentes tienen hits con evalue < 1e-20?

    awk '$7<1E-20 {print $1}' tablast_12 | sort | uniq | wc -l #   1361 hits con evalue menor a 1e-20



### Respuesta (2.a)

	2.b. ¿Qué porcentaje de los hits tienen evalue menor a 1e-20 e identidad superior al 50%?

### Respuesta (2.b)

awk '$7<1E-20 {print $0}' tablast_12 | awk '$3>50 {print$0}' | wc -l # 156 hits
wc -l tablast_12 # 6413 hits

156/6413*100 = 2,43%


3. Utilizando R:
	3.a. Importa la tabla tablast_12 y guárdala en un objeto llamado tablast.

 

### Respuesta (3.a)

read.table("tablast_12") -> tablast

	3.b. Agregar los nombres de las columnas a la tabla


### Respuesta (3.b)

> colnames(tablast) <- c("qseqid","sseqid","pident","sstart","send","slen","evalue","bitscore")	

3.c. Grafica los porcentajes de identidad de la tabla en un boxplot. Exporta el gráfico en un archivo .pdf. 


### Respuesta (3.c)


> pident <- tablast$pident
> boxplot(pident) 


	3.d. Calcula la cobertura de cada hit, a partir del rango de posiciones cubiertas en las secuencias subject. Almacenala en un vector llamado cobertura.


### Respuesta (3.d)

	cobertura <- (tablast$send-tablast$sstart)/tablast$slen



	3.e. Crea y exporta una tabla llamada tabla2 a partir de tablast, que contenga todas las filas y las siguientes columnas:
		1. qseqid
		2. sseqid
		3. pident
		4. cobertura
	     El archivo con la tabla debe llamarse tabla2.tsv, conservar los nombres de columnas, con tabulaciones como separadores de columnas, y sin nombres de filas.	

### Respuesta (3.e)

	tabla2 <- tablast[,c(1,2,3)]
	tabla2 <- cbind.data.frame(tabla2, cobertura)
	write.table(tabla2, file = "tabla2.tsv", row.names=F, sep = "\t")



	